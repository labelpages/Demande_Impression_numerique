
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Demande d'impression num√©rique</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
                         Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            background-color: #f5f5f7;
            color: #1c1c1e;
            padding: 2rem;
            max-width: 900px;
            margin: auto;
        }
        h1 {
  text-align: center;
  color: #007aff;
}

h2 {
  text-align: left;
  color: #E87722;
  margin-bottom: 0.5rem;
}
            text-align: center;
            color: #007aff;
        }
        form {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        label {
            font-weight: 500;
        }
        input, select, textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ccc;
            border-radius: 0.6rem;
            font-size: 1rem;
        }
        textarea {
            resize: vertical;
        }
        button {
    background-color: #E87722;
    font-weight: bold;
    color: white;
    padding: 0.8rem 2rem;
    font-size: 1.1rem;
    border: none;
    border-radius: 0.6rem;
    cursor: pointer;
    display: block;
    margin: 2rem auto 1rem auto;
    background-color: #E87722;
    font-weight: bold;
    margin-top: 2rem;
            background-color: #007aff;
            color: white;
            padding: 0.8rem 2rem;
            font-size: 1.1rem;
            border: none;
            border-radius: 0.6rem;
            cursor: pointer;
            display: block;
            margin: auto;
        }
        .note {
            font-size: 0.95rem;
            background: #f0f0f0;
            padding: 1rem;
            border-left: 4px solid #007aff;
            border-radius: 0.5rem;
        }
        .logo {
            display: block;
            margin: auto;
            width: 200px;
        }
        footer {
            text-align: center;
            font-size: 0.9rem;
            margin-top: 4rem;
            color: #888;
        }
        footer img {
            height: 40px;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>

<img src="https://labelpages.printsafe.net/wp-content/uploads/2020/01/LABEL_New-logo-QUAD.svg" alt="Labelpages Logo" class="logo">
<h1>Demande d'impression num√©rique</h1>

<form id="printForm" style="margin-bottom: 2rem;">

<section>
    <h2>Mes coordonn√©es</h2>
    <label>Pr√©nom <input type="text" id="prenom"></label>
    <label>Nom <input type="text" id="nom"></label>
    <label>Num√©ro de t√©l√©phone <input type="tel" id="tel"></label>
    <label>Adresse email <input type="email" id="email"></label>
    <label>√âcole et section <input type="text" id="ecole"></label>
    <label>D√©lai souhait√© <input type="text" id="delai"></label>
</section>

<section>
    <h2>Ma demande d‚Äôimpression</h2>
    <label>Quantit√© <input type="number" id="quantite"></label>
    <label>Format fini <input type="text" id="format"></label>
    <label>Orientation 
        <select id="orientation">
            <option value="portrait">Portrait</option>
            <option value="paysage">Paysage</option>
        </select>
    </label>
    <label>Nombre de pages int√©rieures (faces) <input type="number" id="pagesInterieures"></label>
    <label>Papier int√©rieur 
        <select id="papierInterieur">
            <option>Satin√© blanc - ColorCopy 160g</option>
            <option>Recycl√© super blanc - Circle 140g</option>
            <option>Blanc naturel - Biotop 120g</option>
            <option>Couch√© silk blanc - Magno satin 150g</option>
        </select>
    </label>
    <label>Nombre de pages de couverture <input type="number" id="pagesCouverture" min="2" max="4" step="2"></label>
    <label>Papier couverture 
        <select id="papierCouverture"></select>
    </label>
</section>

<section>
    <h2>La finition</h2>
    <label>Type de finition 
        <select id="finition">
            <option value="agrafage">Piq√ªre √† cheval (agrafage)</option>
            <option value="spirale">Spirale m√©tal</option>
            <option value="doscarre">Dos carr√©-coll√© couverture souple</option>
            <option value="bd">Reliure cartonn√© type BD</option>
        </select>
    </label>
    <div id="noteFinition" class="note" style="font-weight: 500; color: #333;"></div>
</section>

<section>
    <h2>Remarques ou demande sp√©cifique</h2>
    <textarea id="remarques" rows="5"></textarea>
</section>

<section>
    <h2>Transmettre vos fichiers</h2>
    <p>Merci de d√©poser vos fichiers via <a href="https://wetransfer.com/" target="_blank">WeTransfer</a> √† <strong>info@labelpages.com</strong>.</p>
</section>

<button type="submit">Envoyer ma demande</button>
<div id="confirmationMessage" style="text-align:center; margin-top:1rem; color:green; font-weight:500;"></div>
</form>

<footer>
    <p>Contact : Rue Michel Holyman, 12 | 7536 Vaulx (Tournai ‚Äì Belgique) | <a href="mailto:info@labelpages.com">info@labelpages.com</a> | <a href="tel:+3269228339">+32 69 228 339</a></p>
    <img src="https://labelpages.printsafe.net/wp-content/uploads/2020/01/LABEL_New-logo-QUAD.svg" alt="Labelpages logo">
</footer>

<script>
const form = document.getElementById('printForm');
const fields = ['prenom','nom','tel','email','ecole','delai','quantite','format','orientation','pagesInterieures','papierInterieur','pagesCouverture','papierCouverture','finition','remarques'];
fields.forEach(id => {
    const el = document.getElementById(id);
    if (localStorage.getItem(id)) el.value = localStorage.getItem(id);
    el.addEventListener('input', () => {
        localStorage.setItem(id, el.value);
        if (id === 'papierInterieur') updatePapierCouverture(el.value);
        if (id === 'finition') updateNoteFinition(el.value);
    });
});

function updatePapierCouverture(val) {
    const c = document.getElementById('papierCouverture');
    c.innerHTML = '';
    const map = {
        'Satin√© blanc - ColorCopy 160g': 'Carton silk 350g',
        'Recycl√© super blanc - Circle 140g': 'Recycl√© super blanc 350g',
        'Blanc naturel - Biotop 120g': 'Blanc naturel - Biotop 300g',
        'Couch√© silk blanc - Magno satin 150g': 'Carton silk 350g'
    };
    const opt = document.createElement('option');
    opt.value = map[val];
    opt.textContent = map[val];
    c.appendChild(opt);
}
updatePapierCouverture(document.getElementById('papierInterieur').value);

function updateNoteFinition(val) {
    const note = document.getElementById('noteFinition');
    const content = {
        'agrafage': `<strong>D√©lai :</strong> 4 jours ouvrables<br><strong>Fichier :</strong> PDF HD avec bords perdus et traits de coupe<br><em>Multiples de 4 pages requis.</em>`,
        'spirale': `<strong>D√©lai :</strong> 4 jours ouvrables<br><strong>Fichier :</strong> PDF HD avec bords perdus et traits de coupe<br><em>Multiples de 2 pages requis.</em>`,
        'doscarre': `<strong>D√©lai :</strong> 6 jours ouvrables<br><strong>Fichiers :</strong> Int√©rieur en PDF HD pages simples + Couverture avec dos via <a href='https://labelpages.github.io/LOCI/' target='_blank'>ce calculateur</a>`,
        'bd': `<strong>D√©lai :</strong> 10 jours ouvrables<br><strong>Fichiers :</strong> Int√©rieur en PDF HD pages simples + Couverture avec gabarit fourni sur demande`
    };
    note.innerHTML = content[val] || '';
}

function updateNoteFinition(val) {
    const note = document.getElementById('noteFinition');
    let content = '';
    if (val === 'agrafage') {
        content = `<strong>D√©lai :</strong> 4 jours ouvrables apr√®s validation du fichier<br>
        <strong>Fichier √† transmettre :</strong> PDF haute d√©finition avec bords perdus et traits de coupe<br>
        <em>Ce type de reliure n√©cessite imp√©rativement un multiple de 4 pages.</em>`;
    } else if (val === 'spirale') {
        content = `<strong>D√©lai :</strong> 4 jours ouvrables apr√®s validation du fichier<br>
        <strong>Fichier √† transmettre :</strong> PDF haute d√©finition avec bords perdus et traits de coupe<br>
        <em>Ce type de reliure n√©cessite imp√©rativement un multiple de 2 pages.</em>`;
    } else if (val === 'doscarre') {
        content = `<strong>D√©lai :</strong> 6 jours ouvrables apr√®s validation du fichier<br>
        <strong>Fichiers √† transmettre :</strong><br>
        ‚Äì 1 fichier pour les pages int√©rieures au format PDF haute d√©finition avec traits de coupe et fonds perdus en pages simples (pas de planche) - marges int√©rieures de 15mm<br>
        ‚Äì 1 fichier pour les pages de couverture au format PDF haute d√©finition avec traits de coupe et fonds perdus en 1 partie avec un dos tenant compte du nombre de pages int√©rieur<br><br>
        <a href='https://labelpages.github.io/LOCI/' target='_blank' style='display:inline-block; margin-top:0.5rem; padding:0.4rem 1rem; background:{blue_logo}; color:white; border-radius:5px; text-decoration:none; font-weight:bold;'>üìê Calcul avec ce programme</a>`;
    } else if (val === 'bd') {
        content = `<strong>D√©lai :</strong> 10 jours ouvrables apr√®s validation du fichier<br>
        <strong>Fichiers √† transmettre :</strong><br>
        ‚Äì 1 fichier pour les pages int√©rieures au format PDF haute d√©finition avec traits de coupe et fonds perdus en pages simples (pas de planche) - marges int√©rieures de 15mm<br>
        ‚Äì 1 fichier pour les pages de couverture au format PDF haute d√©finition avec traits de coupe et fonds perdus en 1 partie avec un dos tenant compte du nombre de pages int√©rieur d'apr√®s un gabarit fourni par Labelpages sur demande.`;
    }
    note.innerHTML = content;
}
updateNoteFinition(document.getElementById('finition').value);


form.addEventListener('submit', function(e){
    e.preventDefault();
    const d = {};
    fields.forEach(id => d[id] = document.getElementById(id).value);
    const body = encodeURIComponent(
        `Demande d'impression num√©rique\n\n` +
        `Pr√©nom : ${d.prenom}\nNom : ${d.nom}\nT√©l√©phone : ${d.tel}\nEmail : ${d.email}\n` +
        `√âcole / Section : ${d.ecole}\nD√©lai souhait√© : ${d.delai}\n\n` +
        `Quantit√© : ${d.quantite}\nFormat : ${d.format}\nOrientation : ${d.orientation}\n` +
        `Pages int√©rieures : ${d.pagesInterieures}\nPapier int√©rieur : ${d.papierInterieur}\n` +
        `Pages couverture : ${d.pagesCouverture}\nPapier couverture : ${d.papierCouverture}\nFinition : ${d.finition}\n\n` +
        `Remarques : ${d.remarques}\n\nFichiers transmis via WeTransfer √† info@labelpages.com`
    );
    const subject = encodeURIComponent("Demande d'impression TFE");
    document.getElementById('confirmationMessage').innerText = "Votre demande a √©t√© g√©n√©r√©e. Un email s‚Äôouvre automatiquement. Merci !";
    
    const lignes = [
        <html><body>
        <h2>Demande d'impression num√©rique</h2>
        <table border="1" cellpadding="6" cellspacing="0" style="border-collapse: collapse; font-family: sans-serif;">
        <tr><td><strong>Pr√©nom</strong></td><td>${d.prenom}</td></tr>
        <tr><td><strong>Nom</strong></td><td>${d.nom}</td></tr>
        <tr><td><strong>T√©l√©phone</strong></td><td>${d.tel}</td></tr>
        <tr><td><strong>Email</strong></td><td>${d.email}</td></tr>
        <tr><td><strong>√âcole / Section</strong></td><td>${d.ecole}</td></tr>
        <tr><td><strong>D√©lai souhait√©</strong></td><td>${d.delai}</td></tr>
        <tr><td><strong>Quantit√©</strong></td><td>${d.quantite}</td></tr>
        <tr><td><strong>Format</strong></td><td>${d.format}</td></tr>
        <tr><td><strong>Orientation</strong></td><td>${d.orientation}</td></tr>
        <tr><td><strong>Pages int√©rieures</strong></td><td>${d.pagesInterieures}</td></tr>
        <tr><td><strong>Papier int√©rieur</strong></td><td>${d.papierInterieur}</td></tr>
        <tr><td><strong>Pages couverture</strong></td><td>${d.pagesCouverture}</td></tr>
        <tr><td><strong>Papier couverture</strong></td><td>${d.papierCouverture}</td></tr>
        <tr><td><strong>Finition</strong></td><td>${d.finition}</td></tr>
        <tr><td><strong>Remarques</strong></td><td>${d.remarques}</td></tr>
        <tr><td><strong>Fichiers transmis via</strong></td><td>https://wetransfer.com √† info@labelpages.com</td></tr>
        </table>
        </body></html>
    `;
    const body = encodeURIComponent(lignes.join('\n'));
    window.location.href = `mailto:info@labelpages.com,${d.email}?subject=${subject}&body=${body}`;

});
</script>
</body>
</html>
